global:
  resolve_timeout: 5m
  # SMTP –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ email —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
  # smtp_smarthost: 'smtp.gmail.com:587'
  # smtp_from: 'alertmanager@example.com'
  # smtp_auth_username: 'your-email@gmail.com'
  # smtp_auth_password: 'your-app-password'

# –®–∞–±–ª–æ–Ω—ã –¥–ª—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
templates:
  - '/etc/alertmanager/*.tmpl'

# –ú–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—è –∞–ª–µ—Ä—Ç–æ–≤
route:
  group_by: ['alertname', 'cluster', 'service']
  group_wait: 10s
  group_interval: 10s
  repeat_interval: 12h
  receiver: 'default-receiver'
  
  routes:
    # –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –∞–ª–µ—Ä—Ç—ã
    - match:
        severity: critical
      receiver: 'critical-receiver'
      continue: true
      group_wait: 10s
      repeat_interval: 5m

    # –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è
    - match:
        severity: warning
      receiver: 'warning-receiver'
      continue: true
      group_wait: 30s
      repeat_interval: 1h

    # –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã–µ –∞–ª–µ—Ä—Ç—ã
    - match:
        severity: info
      receiver: 'info-receiver'
      group_wait: 1m
      repeat_interval: 4h

    # –ê–ª–µ—Ä—Ç—ã –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º
    - match:
        category: availability
      receiver: 'availability-receiver'
      continue: true

    - match:
        category: performance
      receiver: 'performance-receiver'
      continue: true

    - match:
        category: security
      receiver: 'security-receiver'
      continue: true

# –ü–æ–¥–∞–≤–ª–µ–Ω–∏–µ –¥—É–±–ª–∏—Ä—É—é—â–∏—Ö—Å—è –∞–ª–µ—Ä—Ç–æ–≤
inhibit_rules:
  # –ï—Å–ª–∏ —Å–∞–π—Ç –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω, –Ω–µ –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å –∞–ª–µ—Ä—Ç—ã –æ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
  - source_match:
      severity: 'critical'
      alertname: 'WebsiteDown'
    target_match:
      severity: 'warning'
    equal: ['instance']

  # –ï—Å–ª–∏ Blackbox Exporter –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω, –Ω–µ –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å –∞–ª–µ—Ä—Ç—ã –æ —Å–∞–π—Ç–∞—Ö
  - source_match:
      alertname: 'BlackboxExporterDown'
    target_match_re:
      alertname: 'Website.*'
    equal: ['job']

# –ü–æ–ª—É—á–∞—Ç–µ–ª–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
receivers:
  # –î–µ—Ñ–æ–ª—Ç–Ω—ã–π –ø–æ–ª—É—á–∞—Ç–µ–ª—å (webhook –¥–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–π)
  - name: 'default-receiver'
    webhook_configs:
      - url: 'http://localhost:5001/webhook'
        send_resolved: true

  # –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –∞–ª–µ—Ä—Ç—ã
  - name: 'critical-receiver'
    webhook_configs:
      - url: 'http://localhost:5001/webhook/critical'
        send_resolved: true
    # –†–∞—Å–∫–æ–º–º–µ–Ω—Ç–∏—Ä—É–π—Ç–µ –¥–ª—è email —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
    # email_configs:
    #   - to: 'ops-team@example.com'
    #     headers:
    #       Subject: 'üö® CRITICAL: {{ .GroupLabels.alertname }}'
    #     html: '{{ template "email.default.html" . }}'

  # –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è
  - name: 'warning-receiver'
    webhook_configs:
      - url: 'http://localhost:5001/webhook/warning'
        send_resolved: true
    # email_configs:
    #   - to: 'ops-team@example.com'
    #     headers:
    #       Subject: '‚ö†Ô∏è  WARNING: {{ .GroupLabels.alertname }}'

  # –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã–µ –∞–ª–µ—Ä—Ç—ã
  - name: 'info-receiver'
    webhook_configs:
      - url: 'http://localhost:5001/webhook/info'
        send_resolved: false

  # –ê–ª–µ—Ä—Ç—ã –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏
  - name: 'availability-receiver'
    webhook_configs:
      - url: 'http://localhost:5001/webhook/availability'
        send_resolved: true

  # –ê–ª–µ—Ä—Ç—ã –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
  - name: 'performance-receiver'
    webhook_configs:
      - url: 'http://localhost:5001/webhook/performance'
        send_resolved: true

  # –ê–ª–µ—Ä—Ç—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
  - name: 'security-receiver'
    webhook_configs:
      - url: 'http://localhost:5001/webhook/security'
        send_resolved: true
    # email_configs:
    #   - to: 'security-team@example.com'
    #     headers:
    #       Subject: 'üîí SECURITY: {{ .GroupLabels.alertname }}'

